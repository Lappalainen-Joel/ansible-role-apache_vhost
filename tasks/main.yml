---
    - name: Create site directory if it does not exist.
      file: state=directory path={{ apache_vhost_webroot }} owner=root group=root mode=0755

    - name: Copy a robots.txt
      template: src={{ apache_vhost_robots_txt }} dest={{ apache_vhost_webroot }}/robots.txt owner=root group=root mode=0644
      when: robots_txt is defined

    - name: Apache config for site
      template: src={{vhost_template}} dest=/etc/apache2/sites-available/{{site_name}} owner=root group=root mode=0644

    - name: Enable site in apache config
      file: src=/etc/apache2/sites-available/{{ site_name }} dest=/etc/apache2/sites-enabled/{{ site_name }} owner=root group=root state=link
      notify:
        - reload apache
